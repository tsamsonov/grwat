<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Use this function to test interannual changes or hydrograph separation variables returned by gr_summarize(). Pettitt test is used to detect the change year — i.e. the year which divides the time series into the statistically most differing samples. Student (Welch) and Fisher tests are used to estimate the significance of mean and variance differences of these samples. Theil-Sen test calculates the trend slope value. Mann-Kendall test is performed to reveal the significance of the trend."><title>Test hydrograph changes — gr_test_vars • grwat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test hydrograph changes — gr_test_vars"><meta property="og:description" content="Use this function to test interannual changes or hydrograph separation variables returned by gr_summarize(). Pettitt test is used to detect the change year — i.e. the year which divides the time series into the statistically most differing samples. Student (Welch) and Fisher tests are used to estimate the significance of mean and variance differences of these samples. Theil-Sen test calculates the trend slope value. Mann-Kendall test is performed to reveal the significance of the trend."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">grwat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/grwat.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/baseflow.html">1. Baseflow filtering</a>
    <a class="dropdown-item" href="../articles/separation.html">2. Advanced hydrograph separation</a>
    <a class="dropdown-item" href="../articles/summaries.html">3. Summaries</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tsamsonov/grwat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Test hydrograph changes</h1>
      <small class="dont-index">Source: <a href="https://github.com/tsamsonov/grwat/blob/HEAD/R/test.R" class="external-link"><code>R/test.R</code></a></small>
      <div class="d-none name"><code>gr_test_vars.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use this function to test interannual changes or hydrograph separation variables returned by <code><a href="gr_summarize.html">gr_summarize()</a></code>. Pettitt test is used to detect the change year — i.e. the year which divides the time series into the statistically most differing samples. Student (Welch) and Fisher tests are used to estimate the significance of mean and variance differences of these samples. Theil-Sen test calculates the trend slope value. Mann-Kendall test is performed to reveal the significance of the trend.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gr_test_vars</span><span class="op">(</span><span class="va">df</span>, <span class="va">...</span>, year <span class="op">=</span> <span class="cn">NULL</span>, exclude <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p><code>data.frame</code> as produced by <code><a href="gr_summarize.html">gr_summarize()</a></code> function.</p></dd>


<dt>...</dt>
<dd><p>Names of the tested variables (quoted).</p></dd>


<dt>year</dt>
<dd><p>Integer value of year used to divide series in two samples compared by Student and Fisher tests. Defaults to <code>NULL</code> which means that the year is calculated automatically by Pettitt test.</p></dd>


<dt>exclude</dt>
<dd><p>Integer vector of years to be excluded from tests.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>list</code> of testing results with following elements:</p><table class="table table"><tr><td><strong>Element</strong></td><td><strong>Description</strong></td></tr><tr><td><code>ptt</code></td><td>Pettitt tests for change year</td></tr><tr><td><code>mkt</code></td><td>Mann-Kendall test for trend significance</td></tr><tr><td><code>tst</code></td><td>Theil-Sen test for slope estimation</td></tr><tr><td><code>ts_fit</code></td><td>Theil-Sen linear model fit</td></tr><tr><td><code>tt</code></td><td>Student (Welch) test for significance of mean differences between two periods</td></tr><tr><td><code>ft</code></td><td>Fisher test for significance of variance differences between two periods</td></tr><tr><td><code>year</code></td><td>Integer value of year used to divide series in two samples compared by Student and Fisher tests</td></tr><tr><td><code>maxval</code></td><td>Maximum value for the variable along the full time series</td></tr><tr><td><code>fixed_year</code></td><td>Boolean <code>TRUE</code> or <code>FALSE</code> value indicating if the year was fixed</td></tr><tr><td><code>pvalues</code></td><td>p-values of all tests summarized as a single table for all variables</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Number of observations formally required for various tests: Pettitt &gt; 0, Mann-Kendall &gt; 2, Theil-Sen &gt; 1, Student &gt; 1, Fisher &gt; 1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tsamsonov/grwat" class="external-link">grwat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spas</span><span class="op">)</span> <span class="co"># example Spas-Zagorye data is included with grwat package</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># separate</span></span></span>
<span class="r-in"><span><span class="va">sep</span> <span class="op">=</span> <span class="fu"><a href="gr_separate.html">gr_separate</a></span><span class="op">(</span><span class="va">spas</span>, params <span class="op">=</span> <span class="fu"><a href="gr_get_params.html">gr_get_params</a></span><span class="op">(</span>reg <span class="op">=</span> <span class="st">'center'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="background-color: #BB0000; font-weight: bold;">grwat:</span> data frame is correct</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">grwat:</span> parameters list and types are OK</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize</span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">=</span> <span class="fu"><a href="gr_summarize.html">gr_summarize</a></span><span class="op">(</span><span class="va">sep</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 2 warnings in `dplyr::summarise()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> The first warning was:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `Dspstart = min(.data$Date[which(.data$Qspri &gt; 0)])`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In group 19: `Year1 = 1974`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning in `min.default()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> no non-missing arguments to min; returning Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There was 1 warning in `dplyr::summarise()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `Q30w = condrollmean(.data$Q, .data$Season == 2, 30)`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In group 64: `Year = 2020`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning in `min()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> no non-missing arguments to min; returning Inf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test all variables</span></span></span>
<span class="r-in"><span><span class="va">tests</span> <span class="op">=</span> <span class="fu">gr_test_vars</span><span class="op">(</span><span class="va">vars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view Pettitt test for Qygr</span></span></span>
<span class="r-in"><span><span class="va">tests</span><span class="op">$</span><span class="va">ptt</span><span class="op">$</span><span class="va">Qygr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pettitt's test for single change-point detection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  vl[vl_cmp]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U* = 865, p-value = 9.505e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> probable change point at time K </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view Fisher test for Q30s</span></span></span>
<span class="r-in"><span><span class="va">tests</span><span class="op">$</span><span class="va">ft</span><span class="op">$</span><span class="va">Q30s</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	F test to compare two variances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  d1 and d2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 0.53023, num df = 21, denom df = 41, p-value = 0.1208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2597352 1.1887012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ratio of variances </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0.5302307 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test only Qygr and Q30s using 1978 as fixed year and excluding 1988-1991 yrs</span></span></span>
<span class="r-in"><span><span class="fu">gr_test_vars</span><span class="op">(</span><span class="va">vars</span>, <span class="va">Qygr</span>, <span class="va">Q30s</span>, year <span class="op">=</span> <span class="fl">1978</span>, exclude <span class="op">=</span> <span class="fl">1988</span><span class="op">:</span><span class="fl">1991</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ptt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ptt$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pettitt's test for single change-point detection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  vl[vl_cmp]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U* = 773, p-value = 1.625e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> probable change point at time K </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ptt$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pettitt's test for single change-point detection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  vl[vl_cmp]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U* = 661, p-value = 1.308e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> probable change point at time K </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mkt$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Mann-Kendall trend test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  vl[vl_cmp]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 4.6112, n = 60, p-value = 4.003e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true S is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            S         varS          tau </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.240000e+02 2.458333e+04 4.090395e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mkt$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Mann-Kendall trend test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  vl[vl_cmp]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 3.272, n = 60, p-value = 0.001068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true S is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            S         varS          tau </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.140000e+02 2.458133e+04 2.905597e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tst</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tst$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Sen's slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  df.theil[[2]][fltr]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 4.6112, n = 60, p-value = 4.003e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true z is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.06134963 0.13936618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sen's slope </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.09717393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tst$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Sen's slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  df.theil[[2]][fltr]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 3.272, n = 60, p-value = 0.001068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true z is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.02823611 0.09316667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sen's slope </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.06039279 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ts_fit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ts_fit$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mblm::mblm(formula = eval(frml), dataframe = df.theil[fltr, ], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     repeated = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        Year1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -157.23729      0.08532  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ts_fit$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mblm::mblm(formula = eval(frml), dataframe = df.theil[fltr, ], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     repeated = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        Year1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -101.1759       0.0549  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tt$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Welch Two Sample t-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  d1 and d2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = -8.9725, df = 47.147, p-value = 9.134e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in means is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -5.645794 -3.577900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean of x mean of y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9.141565 13.753412 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tt$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Welch Two Sample t-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  d1 and d2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = -6.7982, df = 47.426, p-value = 1.586e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in means is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -4.104838 -2.230513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean of x mean of y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.100841  9.268517 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ft</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ft$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	F test to compare two variances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  d1 and d2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 0.72219, num df = 20, denom df = 38, p-value = 0.4414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.3459533 1.6589976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ratio of variances </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0.7221932 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ft$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	F test to compare two variances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  d1 and d2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 0.71161, num df = 20, denom df = 38, p-value = 0.4204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.3408856 1.6346959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ratio of variances </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0.7116142 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Qygr Q30s </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1978 1978 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $maxval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $maxval$Qygr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.07168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $maxval$Q30s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13.16333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fixed_year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pvalues</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N                                    Variable Change.Year   Trend      M1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 Mean annual groundwater ("baseflow") runoff        1978 0.08532 9.14156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2       Minimum 30-day averaged summer runoff        1978 0.05490 6.10084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         M2 MeanRatio     sd1     sd2 sdRatio Mann.Kendall Pettitt Student</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 13.75341      50.4 1.78279 2.09785    17.7      0.00000   0e+00       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  9.26852      51.9 1.61105 1.90980    18.5      0.00107   1e-05       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Fisher</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.44141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.42036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Timofey Samsonov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

