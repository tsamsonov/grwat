<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1. Baseflow filtering • grwat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Baseflow filtering">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grwat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/grwat.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/baseflow.html">1. Baseflow filtering</a></li>
    <li><a class="dropdown-item" href="../articles/separation.html">2. Advanced hydrograph separation</a></li>
    <li><a class="dropdown-item" href="../articles/summaries.html">3. Summaries</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tsamsonov/grwat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>1. Baseflow filtering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tsamsonov/grwat/blob/master/vignettes/baseflow.Rmd" class="external-link"><code>vignettes/baseflow.Rmd</code></a></small>
      <div class="d-none name"><code>baseflow.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tsamsonov/grwat" class="external-link">grwat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<p><strong><code>grwat</code></strong> implements several methods for
baseflow filtering, including those by <span class="citation">Lyne and
Hollick (1979)</span>, <span class="citation">Chapman (1991)</span>,
<span class="citation">Boughton (1993)</span>, <span class="citation">Jakeman and Hornberger (1993)</span> and <span class="citation">Chapman and Maxwell (1996)</span>. The
<code>get_baseflow()</code> function does the job:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Qbase</span> <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">spas</span><span class="op">$</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'lynehollick'</span>, a <span class="op">=</span> <span class="fl">0.925</span>, passes <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Qbase</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.698598 3.789843 3.876099 3.958334 4.037031 4.112454</span></span></code></pre></div>
<p>Though <code>get_baseflow()</code> needs just a vector of runoff
values, it can be applied in a traditional tidyverse pipeline like
follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate baseflow using Jakeman approach</span></span>
<span><span class="va">hdata</span> <span class="op">=</span> <span class="va">spas</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Qbase <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'jakeman'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize for 2020 year</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hdata</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Q</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'steelblue'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Qbase</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'orangered'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19800101</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19801231</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 23376 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span>
<span><span class="co">#&gt; Removed 23376 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span></code></pre></div>
<p><img src="baseflow_files/figure-html/unnamed-chunk-3-1.png" width="960"></p>
<p>Different methods can be compared in a similar way:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hdata</span> <span class="op">=</span> <span class="va">spas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lynehollick <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'lynehollick'</span>, a <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>         boughton <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'boughton'</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>         jakeman <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'jakeman'</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>         maxwell <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'maxwell'</span>, k <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">lynehollick</span><span class="op">:</span><span class="va">maxwell</span>, names_to <span class="op">=</span> <span class="st">'Method'</span>, values_to <span class="op">=</span> <span class="st">'Qbase'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hdata</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Q</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'steelblue'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Qbase</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'orangered'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19810101</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19811231</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Method</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 93508 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span>
<span><span class="co">#&gt; Removed 93508 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span></code></pre></div>
<p><img src="baseflow_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<p>In case of 100% hydraulic connection between ground waters and river
discharge, according to <span class="citation">Kudelin (1960)</span> the
baseflow is equal to zero level at the point of maximum discharge during
the spring flood event. Since extraction of the spring flood requires
meteorological data, it cannot be extracted by simple filtering.
Instead, you can use the advanced separation method by <span class="citation">Rets et al. (2022)</span>, which incorporates Kudelin’s
approach during the spring flood:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/gr_get_params.html">gr_get_params</a></span><span class="op">(</span><span class="st">'center'</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">filter</span> <span class="op">=</span> <span class="st">'kudelin'</span></span>
<span></span>
<span><span class="va">hdata</span> <span class="op">=</span> <span class="va">spas</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lynehollick <span class="op">=</span> <span class="fu"><a href="../reference/gr_baseflow.html">gr_baseflow</a></span><span class="op">(</span><span class="va">Q</span>, method <span class="op">=</span> <span class="st">'lynehollick'</span>, </span>
<span>                                   a <span class="op">=</span> <span class="fl">0.925</span>, passes <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>         kudelin <span class="op">=</span> <span class="fu"><a href="../reference/gr_separate.html">gr_separate</a></span><span class="op">(</span><span class="va">spas</span>, <span class="va">p</span><span class="op">)</span><span class="op">$</span><span class="va">Qbase</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">lynehollick</span><span class="op">:</span><span class="va">kudelin</span>, names_to <span class="op">=</span> <span class="st">'Method'</span>, values_to <span class="op">=</span> <span class="st">'Qbase'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">grwat:</span> data frame is correct</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">grwat:</span> parameters list and types are OK</span></span>
<span></span>
<span><span class="co"># Visualize for 1980 year</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hdata</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Q</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'steelblue'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Date</span>, <span class="va">Qbase</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">'orangered'</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19800101</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fl">19801231</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Method</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 46752 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span>
<span><span class="co">#&gt; Removed 46752 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_align()`).</span></span></code></pre></div>
<p><img src="baseflow_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-boughton1993" class="csl-entry">
Boughton, W. C. 1993. <span>“A Hydrograph-Based Model for Estimating
Water Yield of Ungauged Catchments.”</span> In <em>Institute of
Engineers Australia National Conference</em>, 93/14:317–24.
</div>
<div id="ref-chapman1991" class="csl-entry">
Chapman, T. G. 1991. <span>“Comment on <span>“</span>Evaluation of
Automated Techniques for Base Flow and Recession Analyses<span>”</span>
by R. J. Nathan and T. A. McMahon.”</span> <em>Water Resources
Research</em> 27 (7): 1783–84.
</div>
<div id="ref-maxwell1996" class="csl-entry">
Chapman, T. G., and A. I. Maxwell. 1996. <span>“Baseflow Separation -
Comparison of Numerical Methods with Tracer Experiments.”</span> In
<em>Hydrology and Water Resources Symposium</em>, 539–45.
</div>
<div id="ref-jakeman1993" class="csl-entry">
Jakeman, A. J., and G. M. Hornberger. 1993. <span>“How Much Complexity
Is Warranted in a Rainfall-Runoff Model?”</span> <em>Water Resources
Research</em> 29 (8): 2637–49.
</div>
<div id="ref-kudelin1960" class="csl-entry">
Kudelin, B. I. 1960. <em>Principles for Regional Assessment of Natural
Groundwater Resources [in Russian: Принципы Региональной Оценки
Естественных Ресурсов Подземных Вод]</em>. Moscow, Russia: Moscow State
University.
</div>
<div id="ref-lynehollick1979" class="csl-entry">
Lyne, V., and M. Hollick. 1979. <span>“Stochastic Time-Variable
Rainfall-Runoff Modeling.”</span> In <em>Australian National Conference
Publication</em>, 79:89–92.
</div>
<div id="ref-rets2022" class="csl-entry">
Rets, E. P., M. B. Kireeva, T. E. Samsonov, N. N. Ezerova, A. V.
Gorbarenko, and N. L. Frolova. 2022. <span>“Algorithm Grwat for
Automated Hydrograph Separation by B. I. Kudelin<span>’</span>s Method:
Problems and Perspectives.”</span> <em>Water Resources</em> 49 (1):
23–37.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Timofey Samsonov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
